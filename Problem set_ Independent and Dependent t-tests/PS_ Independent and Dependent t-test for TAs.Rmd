---
title: "PS: Indpendent and Dependent t-test for TAs"
author: "Pablo E. Guti√©rrez-Fonseca"
date: "2023-08-11"
output: pdf_document
---

**R practice.<br />**  
\vspace{1em}

**Install packages.<br />**  
```{r}
library(car)
library(ggplot2)
library(dplyr)
```
\vspace{1em}

**Load the Bird Migration data into R.<br />**   
```{r, echo=FALSE}
df_bird_all <- read.csv('C:/Users/Guti/OneDrive - University of Vermont/Curriculum/07_ Cursos/NR-2400/Problem set_ Independent and Dependent t-tests/Bird_Migration.csv')
head(df_bird_all)
```
\vspace{1em}

Make a subgroup of Weight before migration (Pre_weight).
```{r}
df_bird_Pre_weight <- df_bird_all %>% 
  filter(Treatment == 'Pre_weight')

summary(df_bird_Pre_weight)
```
\vspace{10em}



**Part I.**  
**2. Analyze data distribution. Is your pre-weight data normally distributed?**  
```{r}
shapiro.test(df_bird_Pre_weight$value)
```
\vspace{1em}

**3. Test to see if you meet the assumption of equal variance for this test. Based on the results of this test for unequal variance, which test should you use?**  
```{r}
# Perform Levene's test
result <- leveneTest(value~Gender, data=df_bird_Pre_weight)
print(result)
```
\vspace{1em} 

```{r}
p_value <- result$Pr[1]
# Significance level
alpha <- 0.05

# Interpret the result
if (p_value < alpha) {
  cat("Reject null hypothesis: Variances are significantly different.\n")
} else {
  cat("Fail to reject null hypothesis: Variances are not significantly different.\n")
}
```
\vspace{1em}

**4. Run this analysis. What is the test statistic (obtained) value for the test you selected?**<br />  
 Use alternative to determine your hypothesis. Default= "two.sided".<br />   
 alternative = c("two.sided", "less", "greater"),
```{r}
# Perform t-test
t_test_result <- t.test(value~Gender,alternative = "two.sided",
                         var.equal=TRUE, data=df_bird_Pre_weight)
print(t_test_result)
```
\vspace{1em}

```{r}
# Create a boxplot plot using ggplot2
ggplot(df_bird_Pre_weight, aes(x = Gender, y = value)) +
  geom_boxplot()  # Add jitter for better visualization
```
\vspace{10em}




**Part II.**  
**Analyze data distribution. Is your pre-weight data normally distributed?**  
```{r}
shapiro.test(df_bird_Pre_weight$value)
```
\vspace{1em}

**Test to see if you meet the assumption of equal variance for this test. Based on the results of this test for unequal variance, which test should you use?**  
```{r}
# Perform Levene's test
result <- leveneTest(value~Species, data=df_bird_Pre_weight)
print(result)
```
\vspace{1em} 

```{r}
p_value <- result$Pr[1]
# Significance level
alpha <- 0.05

# Interpret the result
if (p_value < alpha) {
  cat("Reject null hypothesis: Variances are significantly different.\n")
} else {
  cat("Fail to reject null hypothesis: Variances are not significantly different.\n")
}
```
\vspace{1em}

**8. Run this analysis. What is the test statistic (obtained) value for the test you selected?**<br />  
 Use alternative to determine your hypothesis. Default= "two.sided".<br />   
 alternative = c("two.sided", "less", "greater"),
```{r}
# Perform t-test
t_test_result <- t.test(value~Species, alternative = "two.sided",
                         var.equal=TRUE, data=df_bird_Pre_weight)
print(t_test_result)
```
\vspace{1em}

```{r}
# Create a boxplot plot using ggplot2
ggplot(df_bird_Pre_weight, aes(x = Species, y = value)) +
  geom_boxplot()  # Add jitter for better visualization
```
\vspace{10em}


**Part III.**
**12. Analyze data distribution. Is your pre-weight data normally distributed?**  
```{r}
shapiro.test(df_bird_all$value)
```
\vspace{1em}


**Test to see if you meet the assumption of equal variance for this test. Based on the results of this test for unequal variance, which test should you use?**  
```{r}
# Perform Levene's test
result_paired_t_test <- leveneTest(value~Treatment, data=df_bird_all)
print(result_paired_t_test)
```
\vspace{1em} 

```{r}
p_value <- result_paired_t_test$Pr[1]
# Significance level
alpha <- 0.05

# Interpret the result
if (p_value < alpha) {
  cat("Reject null hypothesis: Variances are significantly different.\n")
} else {
  cat("Fail to reject null hypothesis: Variances are not significantly different.\n")
}
```
\vspace{1em}

**Perform and Print the paired t-test result.**
```{r}
t_paired_result <- t.test(value ~ Treatment, paired = TRUE, 
                          data = df_bird_all)
print(t_paired_result)
```
\vspace{1em}


```{r}
# Create a boxplot plot using ggplot2
ggplot(df_bird_all, aes(x = Treatment, y = value)) +
  geom_boxplot()  # Add jitter for better visualization
```
\vspace{10em}


**Part IV.**
**From the data.frame make two groups (females and males)**
```{r}
df_bird_female <- df_bird_all %>% 
  filter(Gender == 'F')
```
\vspace{1em}

```{r}
df_bird_male <- df_bird_all %>% 
  filter(Gender == 'M')
```
\vspace{1em}

**Assumptions for Females**
```{r}
shapiro.test(df_bird_female$value)
leveneTest(value~Treatment, data=df_bird_female)
```
\vspace{1em}

**Perform and Print the paired t-test result**
```{r}
t_paired_female <- t.test(value ~ Treatment, paired = TRUE, 
                          alternative= 'less', 
                          data = df_bird_female)
print(t_paired_female)
```
\vspace{2em}

**Assumptions for Males**
```{r}
shapiro.test(df_bird_male$value)
leveneTest(value~Treatment, data=df_bird_male)
```
\vspace{1em}

**Perform and Print the paired t-test result**
```{r}
t_paired_male <- t.test(value ~ Treatment, paired = TRUE, 
                        alternative= 'less',
                        data = df_bird_male)
print(t_paired_male)
```


